{"version":3,"sources":["webpack:///./node_modules/@material-ui/icons/ExpandMore.js","webpack:///./src/components/services/useRoleManager.ts","webpack:///./src/components/services/useServiceRole.ts","webpack:///./src/components/services/ServiceRole.tsx","webpack:///./src/components/dashboard/DashboardServiceWidgetItem.tsx","webpack:///./src/components/dashboard/DashboardServiceDetails.tsx","webpack:///./src/components/hooks/useIntersectionObserver.ts","webpack:///./src/components/dashboard/DashboardDevice.tsx","webpack:///./node_modules/@material-ui/icons/ExpandLess.js","webpack:///./src/components/dashboard/DashboardButton.tsx","webpack:///./src/components/dashboard/DashboardServo.tsx","webpack:///./src/components/dashboard/DashboardRotaryEncoder.tsx","webpack:///./src/components/dashboard/DashboardSwitch.tsx","webpack:///./src/components/dashboard/DashboardServiceWidget.tsx"],"names":["useRoleManager","useContext","JacdacContext","bus","useState","roleManager","mgr","setMgr","useEffect","subscribe","ROLE_MANAGER_CHANGE","useServiceRole","service","role","setRole","ROLE_CHANGE","console","log","ServiceRole","props","AppContext","showSelectRoleDialog","handleClick","hasRoleForService","useChange","_","DashboardServiceWidgetItem","useRegisterUnpackedValue","register","SystemReg","InstanceName","instanceName","float","ignoreRegisters","StatusCode","StreamingPreferredInterval","StreamingSamples","StreamingInterval","collapsedRegisters","Reading","Value","Intensity","DashboardServiceDetails","expanded","specification","spec","registers","useMemo","packets","ids","filter","pkt","isRegister","map","identifier","id","indexOf","slice","reg","length","useIntersectionObserver","elementRef","options","entry","setEntry","threshold","root","rootMargin","freezeOnceVisible","frozen","isIntersecting","updateEntry","node","current","hasIOSupport","window","IntersectionObserver","observerParams","observer","observe","disconnect","ignoredServices","SRV_CTRL","SRV_LOGGER","DashboardDevice","device","toggleExpanded","variant","showAvatar","showHeader","name","useDeviceName","services","serviceClass","useDeviceSpecification","theme","useTheme","mobile","useMediaQuery","breakpoints","down","MOBILE_BREAKPOINT","serviceGridRef","useRef","intersection","visible","ServiceWidgets","useCallback","dependencyId","padding","paddingBottom","paddingTop","serviceIndex","DashboardButton","pressed","setPressed","pressedRegister","ButtonReg","Pressed","REPORT_UPDATE","unpackedValue","b","undefined","downEvent","event","ButtonEvent","Down","EVENT","upEvent","Up","host","useServiceHost","color","label","handleDown","handleUp","up","widgetSize","useActualAngle","ServoReg","Angle","angle","ResponseSpeed","responseSpeed","rotationalSpeed","SG90_RESPONSE_SPEED","actualAngle","useThrottledValue","DashboardServo","enabledRegister","Enabled","enabled","useRegisterBoolValue","off","angleRegister","Offset","offset","useWidgetTheme","background","controlBackground","active","textPrimary","cx","cy","a","transform","h","w","pr","pri","text","Math","round","toggleOff","sendSetBoolAsync","refresh","DashboardRotaryEncoder","positionRegister","RotaryEncoderReg","Position","position","clicksPerTurnRegister","ClicksPerTurn","clicksPerTurn","textProps","r","fs","max","handleChange","ev","newValue","reading","setValues","throttled","min","floor","ceil","DashboardSwitch","labelId","useId","on","SwitchReg","Active","Variant","switchVariant","handleToggle","toggle","SwitchVariant","PushButton","DashboardAccelerometer","lazy","DashboardBuzzer","DashboardLEDPixel","DashboardRoleManager","DashboardTrafficLight","DashboardCharacterScreen","DashboardRainGauge","DashboardLEDMatrix","DashboardArcadeGamepad","DashboardWindDirection","DashboardMatrixKeypad","DashboardReflectedLight","DashboardPower","DashboardSpeechSynthesis","DashboardSoilMoisture","DashboardRealTimeClock","DashboardLED","DashboardJoystick","DashboardSevenSegmentDisplay","DashboardMotion","DashboardWaterLevel","DashboardColor","DashboardSoundPlayer","DashboardAnalogButton","DashboardSoundLevel","DashboardSoundSpectrum","DashboardRandomNumberGenerator","DashboardCompass","DashboardGyroscope","DashboardSolenoid","serviceViews","SRV_ROLE_MANAGER","component","weight","SRV_BUZZER","SRV_LED_PIXEL","SRV_ACCELEROMETER","SRV_ROTARY_ENCODER","bundled","SRV_BUTTON","SRV_SERVO","SRV_SWITCH","SRV_TRAFFIC_LIGHT","SRV_CHARACTER_SCREEN","SRV_RAIN_GAUGE","SRV_LED_MATRIX","SRV_ARCADE_GAMEPAD","SRV_WIND_DIRECTION","SRV_MATRIX_KEYPAD","SRV_REFLECTED_LIGHT","SRV_POWER","SRV_SPEECH_SYNTHESIS","SRV_SOIL_MOISTURE","SRV_REAL_TIME_CLOCK","SRV_LED","SRV_JOYSTICK","SRV_SEVEN_SEGMENT_DISPLAY","SRV_MOTION","SRV_WATER_LEVEL","SRV_COLOR","SRV_SOUND_PLAYER","SRV_ANALOG_BUTTON","SRV_SOUND_LEVEL","SRV_RNG","SRV_COMPASS","SRV_GYROSCOPE","SRV_SOUND_SPECTRUM","SRV_SOLENOID","ValueWidget","valueRegister","intensityRegister","others","intensity","hasIntensity","IntensityWidget","DefaultWidget","rspec","find","DashboardServiceWidget","classIdentifier","createElement","dashboardServiceWeight","view"],"mappings":"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","file":"f45028b77642bb06a1e26ecfd1b9356bfb549ad6-61f9c2d6b1325546e300.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z\"\n}), 'ExpandMore');\n\nexports.default = _default;","import { useContext, useEffect, useState } from \"react\"\nimport { ROLE_MANAGER_CHANGE } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { RoleManagerClient } from \"../../../jacdac-ts/src/jdom/rolemanagerclient\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\n\nexport default function useRoleManager(): RoleManagerClient {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const [mgr, setMgr] = useState<RoleManagerClient>(bus.roleManager)\n    useEffect(() =>\n        bus.subscribe(ROLE_MANAGER_CHANGE, () => setMgr(bus.roleManager))\n    )\n    return mgr\n}\n","import { useEffect, useState } from \"react\"\nimport { ROLE_CHANGE } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\n\nexport default function useServiceRole(service: JDService) {\n    const [role, setRole] = useState<string>(service?.role);\n    useEffect(() => service?.subscribe(ROLE_CHANGE, () => {\n        console.log(\"role change\", { service })\n        setRole(service.role)\n    }), [service])\n    return role;\n}","import { Button } from \"@material-ui/core\"\nimport React, { useContext } from \"react\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\nimport useChange from \"../../jacdac/useChange\"\nimport AppContext from \"../AppContext\"\nimport useRoleManager from \"./useRoleManager\"\nimport useServiceRole from \"./useServiceRole\"\n\nexport default function ServiceRole(props: { service: JDService }) {\n    const { service } = props\n    const { showSelectRoleDialog } = useContext(AppContext)\n    const roleManager = useRoleManager()\n    const role = useServiceRole(service)\n    const handleClick = () => showSelectRoleDialog(service)\n\n    const hasRoleForService = useChange(roleManager, _ => _?.hasRoleForService(service))\n    // hide if no role manager or role not compatible with required roles\n    if (!hasRoleForService)\n        return null;\n\n    return <Button size=\"small\" onClick={handleClick}>{role || \"...\"}</Button>\n}\n","import { Grid, Typography } from \"@material-ui/core\"\nimport React from \"react\"\nimport DashboardServiceWidget, {\n    DashboardServiceProps,\n} from \"./DashboardServiceWidget\"\nimport ServiceRole from \"../services/ServiceRole\"\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport { SystemReg } from \"../../../jacdac-ts/src/jdom/constants\"\n\nexport default function DashboardServiceWidgetItem(\n    props: React.Attributes & DashboardServiceProps\n): JSX.Element {\n    const { service } = props\n    const [instanceName] = useRegisterUnpackedValue<[number]>(\n        service.register(SystemReg.InstanceName),\n        props\n    )\n\n    return (\n        <Grid item>\n            <ServiceRole service={service} />\n            {instanceName && (\n                <Typography\n                    className=\"no-pointer-events\"\n                    variant=\"caption\"\n                    component=\"span\"\n                    style={{ float: \"right\" }}\n                >\n                    {instanceName}\n                </Typography>\n            )}\n            <DashboardServiceWidget {...props} />\n        </Grid>\n    )\n}\n","import React, { useMemo } from \"react\";\nimport { BaseReg, SystemReg } from \"../../../jacdac-ts/src/jdom/constants\";\nimport useChange from \"../../jacdac/useChange\";\nimport RegisterInput from \"../RegisterInput\";\nimport { isIntegerType, isRegister } from \"../../../jacdac-ts/src/jdom/spec\";\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\";\nimport { Grid } from \"@material-ui/core\";\nimport { JDRegister } from \"../../../jacdac-ts/src/jdom/register\";\n\n// filter out common registers\nconst ignoreRegisters = [\n    SystemReg.StatusCode,\n    SystemReg.StreamingPreferredInterval,\n    SystemReg.StreamingSamples,\n    SystemReg.StreamingInterval\n]\nconst collapsedRegisters = [\n    SystemReg.Reading,\n    SystemReg.Value,\n    SystemReg.Intensity\n]\n\nexport default function DashboardServiceDetails(props: DashboardServiceProps) {\n    const { service, expanded } = props;\n    const specification = useChange(service, spec => spec.specification);\n    const registers: JDRegister[] = useMemo(() => {\n        const packets = specification?.packets;\n        let ids = packets\n            ?.filter(pkt => isRegister(pkt))\n            ?.map(pkt => pkt.identifier) || []\n        ids = ids.filter(id => ignoreRegisters.indexOf(id) < 0)\n        if (!expanded) // grab the first interresting register\n            ids = ids.filter(id => collapsedRegisters.indexOf(id) > -1)\n                .slice(0, 1);\n        return ids.map(id => service.register(id))\n            .filter(reg => !!reg);\n    }, [specification, expanded])\n\n    if (!registers?.length)  // nothing to see here\n        return null;\n\n    return <>\n        {registers.map(register => {\n            return <Grid key={register.id} item xs={true}><RegisterInput\n                register={register}\n                showServiceName={true}\n                showRegisterName={true}\n                hideMissingValues={false}\n                showTrend={false}\n            /></Grid>\n        })}\n    </>\n}\n","import { useEffect, useState, RefObject } from 'react'\n\nexport interface Args extends IntersectionObserverInit {\n  freezeOnceVisible?: boolean\n}\n\nexport default function useIntersectionObserver(\n  elementRef: RefObject<Element>,\n  options?: { freezeOnceVisible?: boolean } & IntersectionObserverInit\n): IntersectionObserverEntry | undefined {\n  const [entry, setEntry] = useState<IntersectionObserverEntry>()\n  const { threshold = 0, root = null, rootMargin = '0%', freezeOnceVisible } = options || {};\n\n  const frozen = entry?.isIntersecting && freezeOnceVisible\n\n  const updateEntry = ([entry]: IntersectionObserverEntry[]): void => {\n    setEntry(entry)\n  }\n\n  useEffect(() => {\n    const node = elementRef?.current // DOM Ref\n    const hasIOSupport = !!window.IntersectionObserver\n\n    if (!hasIOSupport || frozen || !node) return\n\n    const observerParams = { threshold, root, rootMargin }\n    const observer = new IntersectionObserver(updateEntry, observerParams)\n\n    //console.log(`observe`, { node })\n    observer.observe(node)\n\n    return () => observer.disconnect()\n\n  }, [elementRef, threshold, root, rootMargin, frozen])\n\n  return entry\n}\n","import {\n    Card,\n    CardContent,\n    CardHeader,\n    Grid,\n    Paper,\n    Typography,\n    useMediaQuery,\n    useTheme,\n} from \"@material-ui/core\"\nimport React, { useCallback, useRef } from \"react\"\nimport { SRV_CTRL, SRV_LOGGER } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\"\nimport useChange from \"../../jacdac/useChange\"\nimport DeviceName from \"../devices/DeviceName\"\nimport IconButtonWithTooltip from \"../ui/IconButtonWithTooltip\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport ExpandLessIcon from \"@material-ui/icons/ExpandLess\"\nimport useDeviceSpecification from \"../../jacdac/useDeviceSpecification\"\nimport DeviceAvatar from \"../devices/DeviceAvatar\"\nimport DashboardServiceWidgetItem from \"./DashboardServiceWidgetItem\"\nimport DeviceActions from \"../DeviceActions\"\nimport DashboardServiceDetails from \"./DashboardServiceDetails\"\nimport { MOBILE_BREAKPOINT } from \"../layout\"\nimport useDeviceName from \"../devices/useDeviceName\"\nimport { DashboardDeviceProps } from \"./Dashboard\"\nimport useIntersectionObserver from \"../hooks/useIntersectionObserver\"\nimport { dependencyId } from \"../../../jacdac-ts/src/jdom/node\"\n\nconst ignoredServices = [SRV_CTRL, SRV_LOGGER]\n\nexport default function DashboardDevice(\n    props: {\n        device: JDDevice\n        expanded?: boolean\n        toggleExpanded?: () => void\n        variant?: \"icon\" | \"\"\n    } & DashboardDeviceProps\n) {\n    const {\n        device,\n        expanded,\n        toggleExpanded,\n        variant,\n        showAvatar,\n        showHeader,\n    } = props\n    const name = useDeviceName(device)\n    const services = useChange(device, () =>\n        device\n            .services()\n            .filter(\n                service =>\n                    ignoredServices.indexOf(service.serviceClass) < 0 &&\n                    !!service.specification\n            )\n    )\n    const specification = useDeviceSpecification(device)\n    const theme = useTheme()\n    const mobile = useMediaQuery(theme.breakpoints.down(MOBILE_BREAKPOINT))\n    const serviceGridRef = useRef<HTMLDivElement>()\n    const intersection = useIntersectionObserver(serviceGridRef)\n    const visible = !!intersection?.isIntersecting\n\n    const ServiceWidgets = useCallback(() => (\n        <Grid\n            ref={serviceGridRef}\n            component=\"div\"\n            container\n            spacing={2}\n            justify=\"center\"\n            alignItems=\"flex-end\"\n            alignContent=\"space-between\"\n        >\n            {services?.map(service => (\n                <DashboardServiceWidgetItem\n                    key={service.id}\n                    service={service}\n                    expanded={expanded}\n                    services={services}\n                    variant={variant}\n                    visible={visible}\n                />\n            ))}\n        </Grid>\n    ), [dependencyId(services), expanded, variant, visible])\n\n    if (!showHeader)\n        return (\n            <Paper style={{ padding: \"0.25em\" }} variant=\"outlined\">\n                <ServiceWidgets />\n            </Paper>\n        )\n\n    return (\n        <Card aria-live=\"polite\" aria-label={`device ${name} started`}>\n            <CardHeader\n                style={{ paddingBottom: 0 }}\n                avatar={showAvatar && <DeviceAvatar device={device} />}\n                action={\n                    <DeviceActions\n                        device={device}\n                        showStopHost={expanded && !mobile}\n                        hideIdentity={true}\n                        showReset={expanded && !mobile}\n                    >\n                        {toggleExpanded && (\n                            <IconButtonWithTooltip\n                                onClick={toggleExpanded}\n                                title={expanded ? \"Collapse\" : \"Expand\"}\n                            >\n                                {expanded ? (\n                                    <ExpandLessIcon />\n                                ) : (\n                                    <ExpandMoreIcon />\n                                )}\n                            </IconButtonWithTooltip>\n                        )}\n                    </DeviceActions>\n                }\n                title={<DeviceName showShortId={false} device={device} />}\n                subheader={\n                    <>\n                        {!mobile && specification && (\n                            <Typography variant=\"caption\" gutterBottom>\n                                {specification.name}\n                            </Typography>\n                        )}\n                    </>\n                }\n            />\n            <CardContent style={{ paddingTop: 0 }}>\n                <ServiceWidgets />\n                {expanded && (\n                    <Grid\n                        container\n                        direction=\"column\"\n                        spacing={1}\n                        alignContent=\"stretch\"\n                    >\n                        {services?.map(service => (\n                            <DashboardServiceDetails\n                                key={\"details\" + service.serviceIndex}\n                                service={service}\n                                expanded={expanded}\n                            />\n                        ))}\n                    </Grid>\n                )}\n            </CardContent>\n        </Card>\n    )\n}\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z\"\n}), 'ExpandLess');\n\nexports.default = _default;","import React, { useEffect, useState } from \"react\";\nimport { ButtonEvent, ButtonReg, EVENT, REPORT_UPDATE } from \"../../../jacdac-ts/src/jdom/constants\";\nimport ButtonServiceHost from \"../../../jacdac-ts/src/hosts/buttonservicehost\";\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\";\nimport ButtonWidget from \"../widgets/ButtonWidget\";\nimport useServiceHost from \"../hooks/useServiceHost\";\nimport LoadingProgress from \"../ui/LoadingProgress\"\n\nexport default function DashboardButton(props: DashboardServiceProps) {\n    const { service, visible } = props;\n    const [pressed, setPressed] = useState<boolean>(false)\n    const pressedRegister = service.register(ButtonReg.Pressed);\n    // track register\n    useEffect(() => visible && pressedRegister?.subscribe(REPORT_UPDATE, () => {\n        const [b] = pressedRegister?.unpackedValue || [];\n        if (b !== undefined)\n            setPressed(b)\n    }), [pressedRegister, visible])\n    // track event up/down events\n    const downEvent = service.event(ButtonEvent.Down);\n    useEffect(() => downEvent.subscribe(EVENT, () => setPressed(true)), [downEvent])\n    const upEvent = service.event(ButtonEvent.Up);\n    useEffect(() => upEvent.subscribe(EVENT, () => setPressed(false)), [upEvent])\n\n    const host = useServiceHost<ButtonServiceHost>(service);\n    const color = host ? \"secondary\" : \"primary\";\n    const label = `button ${pressed ? `down` : `up`}`\n    const handleDown = () => host?.down();\n    const handleUp = () => host?.up();\n    const widgetSize = `clamp(3rem, 10vw, 16vw)`\n\n    if (pressed === undefined)\n        return <LoadingProgress />;\n    \n    return <ButtonWidget\n        checked={!!pressed}\n        color={color}\n        onDown={host && handleDown}\n        onUp={host && handleUp}\n        label={label}\n        size={widgetSize}\n    />\n}","import React from \"react\"\nimport { ServoReg } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { useRegisterBoolValue, useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport SvgWidget from \"../widgets/SvgWidget\"\nimport useWidgetTheme from \"../widgets/useWidgetTheme\"\nimport useServiceHost from \"../hooks/useServiceHost\"\nimport useThrottledValue from \"../hooks/useThrottledValue\"\nimport { SG90_RESPONSE_SPEED } from \"../../../jacdac-ts/src/hosts/hosts\"\nimport { Grid } from \"@material-ui/core\"\nimport ServoServiceHost from \"../../../jacdac-ts/src/hosts/servoservicehost\"\nimport RegisterInput from \"../RegisterInput\"\nimport PowerButton from \"../widgets/PowerButton\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\n\nfunction useActualAngle(service: JDService, visible: boolean) {\n    const [angle] = useRegisterUnpackedValue<[number]>(\n        service.register(ServoReg.Angle),\n        { visible }\n    )\n    // sec/60deg\n    const [responseSpeed] = useRegisterUnpackedValue<[number]>(\n        service.register(ServoReg.ResponseSpeed),\n        { visible }\n    )\n    const rotationalSpeed = 60 / (responseSpeed || SG90_RESPONSE_SPEED)\n    const actualAngle = useThrottledValue(angle || 0, rotationalSpeed)\n\n    return actualAngle\n}\n\nexport default function DashboardServo(props: DashboardServiceProps) {\n    const { service, visible } = props\n\n    const enabledRegister = service.register(ServoReg.Enabled)\n    const enabled = useRegisterBoolValue(\n        enabledRegister,\n        props\n    )\n    const off = !enabled\n    const angleRegister = service.register(ServoReg.Angle)\n    const angle = useActualAngle(service, visible)\n    const [offset] = useRegisterUnpackedValue<[number]>(\n        service.register(ServoReg.Offset),\n        props\n    )\n\n    const host = useServiceHost<ServoServiceHost>(service)\n    const color = host ? \"secondary\" : \"primary\"\n    const {\n        background,\n        controlBackground,\n        active,\n        textPrimary,\n    } = useWidgetTheme(color)\n\n    const cx = 78\n    const cy = 55\n\n    const a = enabled ? angle + (offset || 0) : 0\n    const transform = `rotate(${-a}, ${cx}, ${cy})`\n    const h = 111.406\n    const w = 158.50195\n    const pr = 14\n    const pri = 6\n    const text = enabled ? `${Math.round(a)}Â°` : \"off\"\n\n    const toggleOff = async () => {\n        await enabledRegister.sendSetBoolAsync(!enabled)\n        enabledRegister.refresh()\n    }\n\n    return (\n        <Grid container alignContent=\"center\">\n            <Grid item xs={12}>\n                <SvgWidget\n                    tabIndex={0}\n                    title={`servo at angle ${angle}`}\n                    width={w}\n                    height={h}\n                >\n                    <path\n                        fill={background}\n                        d=\"M158.502 10.687H0v89.75h158.502z\"\n                    />\n                    <path\n                        fill={controlBackground}\n                        d=\"M125.545 55.641c0-24.994-20.26-45.256-45.254-45.256-17.882.016-34.077 9.446-41.328 25.79-2.655.024-4.192.076-6.35.07-11.158 0-20.204 9.046-20.204 20.204 0 11.158 9.046 20.203 20.203 20.203 2.389-.005 4.354-.332 6.997-.256 7.56 15.59 23.356 24.485 40.682 24.5 24.992 0 45.254-20.264 45.254-45.256z\"\n                    />\n                    <path\n                        fill={enabled ? active : background}\n                        stroke={active}\n                        transform={transform}\n                        d=\"M93.782 55.623c-.032-3.809-.19-6.403-.352-7.023h-.002c-.93-3.558-6.621-6.73-14.793-6.73-8.17 0-14.649 3.016-14.795 6.73-.25 6.419-4.049 62.795 13.561 62.806 14.308.008 16.52-39.277 16.38-55.783zm-8.05.08a7.178 7.178 0 010 .012 7.178 7.178 0 01-7.179 7.176 7.178 7.178 0 01-7.177-7.176 7.178 7.178 0 017.177-7.178 7.178 7.178 0 017.178 7.166z\"\n                    />\n                    <text\n                        x={w / 2}\n                        y={30}\n                        textAnchor=\"middle\"\n                        fill={textPrimary}\n                    >\n                        {text}\n                    </text>\n                    <PowerButton\n                        r={pr}\n                        ri={pri}\n                        cx={w - pr - 4}\n                        cy={pr + 14}\n                        color={color}\n                        strokeWidth={1.5}\n                        off={off}\n                        onClick={toggleOff}\n                    />\n                </SvgWidget>\n            </Grid>\n            <Grid item xs={12}>\n                <RegisterInput register={angleRegister} visible={visible} />\n            </Grid>\n        </Grid>\n    )\n}\n","import React from \"react\"\nimport { RotaryEncoderReg } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport SvgWidget from \"../widgets/SvgWidget\"\nimport useServiceHost from \"../hooks/useServiceHost\"\nimport RotaryEncoderServiceHost from \"../../../jacdac-ts/src/hosts/rotaryencoderservicehost\"\nimport useWidgetTheme from \"../widgets/useWidgetTheme\"\nimport { Grid, Slider } from \"@material-ui/core\"\nimport useThrottledValue from \"../hooks/useThrottledValue\"\n\nexport default function DashboardRotaryEncoder(props: DashboardServiceProps) {\n    const { service } = props\n    const positionRegister = service.register(RotaryEncoderReg.Position)\n    const [position = 0] = useRegisterUnpackedValue<[number]>(\n        positionRegister,\n        props\n    )\n    const clicksPerTurnRegister = service.register(\n        RotaryEncoderReg.ClicksPerTurn,\n        props\n    )\n    const [clicksPerTurn = 12] = useRegisterUnpackedValue<[number]>(\n        clicksPerTurnRegister,\n        props\n    )\n    const host = useServiceHost<RotaryEncoderServiceHost>(service)\n    const color = host ? \"secondary\" : \"primary\"\n    const { background, controlBackground, active, textProps } = useWidgetTheme(\n        color\n    )\n    const label = \"\" + position\n    const widgetSize = `clamp(6rem, 15vw, 20vw)`\n\n    const w = 37.794\n    const r = 0.06\n    const fs = Math.max(0.2, 0.5 - label.length * 0.1)\n\n    const handleChange = async (ev: unknown, newValue: number | number[]) => {\n        host?.reading.setValues([newValue as number])\n        positionRegister.refresh()\n        clicksPerTurnRegister.refresh()\n    }\n\n    const throttled = useThrottledValue(position, clicksPerTurn)\n    const angle = (throttled / clicksPerTurn) * 360\n\n    const min = Math.floor(position / clicksPerTurn - 1) * clicksPerTurn\n    const max = Math.ceil(position / clicksPerTurn + 1) * clicksPerTurn\n\n    return (\n        <Grid container direction=\"column\">\n            <Grid item>\n                <SvgWidget\n                    title={`rotary encoder at position ${position}`}\n                    size={widgetSize}\n                    width={w}\n                    height={w}\n                    viewBox={\"0 0 1 1\"}\n                >\n                    <g transform={`rotate(${angle}, 0.5, 0.5)`}>\n                        <path\n                            fill={background}\n                            d=\"M.67.029a.037.037 0 01-.072-.02A.5.5 0 00.538 0a.037.037 0 01-.075 0 .5.5 0 00-.061.008.038.038 0 01-.073.02.5.5 0 00-.056.025.037.037 0 01-.064.04A.5.5 0 00.16.13.037.037 0 01.11.186a.5.5 0 00-.035.05.037.037 0 01-.035.066.5.5 0 00-.02.058.037.037 0 01-.016.074A.5.5 0 000 .495.037.037 0 01.005.57a.5.5 0 00.013.06.038.038 0 01.025.07.5.5 0 00.028.056.037.037 0 01.043.06.5.5 0 00.042.046.037.037 0 01.058.047.5.5 0 00.053.032.037.037 0 01.069.03.5.5 0 00.059.016.037.037 0 01.074.01.5.5 0 00.062 0 .037.037 0 01.074-.01.5.5 0 00.06-.016.037.037 0 01.068-.03.5.5 0 00.053-.032.037.037 0 01.058-.047.5.5 0 00.042-.045.037.037 0 01.043-.061A.5.5 0 00.957.7.037.037 0 01.982.63.5.5 0 00.995.57.037.037 0 011 .495.5.5 0 00.996.434.038.038 0 01.98.36.5.5 0 00.96.302.037.037 0 01.925.236.5.5 0 00.89.186.037.037 0 01.839.13.5.5 0 00.79.092.037.037 0 01.727.053.5.5 0 00.671.03z\"\n                        />\n                        <path\n                            fill={controlBackground}\n                            d=\"M.1.499a.4.4 0 10.8 0 .4.4 0 10-.8 0z\"\n                        />\n                        <circle cx={0.5} cy={0.19} r={r} fill={active} />\n                    </g>\n                    <text x={0.5} y={0.5} fontSize={fs} {...textProps}>\n                        {label}\n                    </text>\n                </SvgWidget>\n            </Grid>\n            {host && (\n                <Grid item>\n                    <Slider\n                        color={color}\n                        min={min}\n                        max={max}\n                        step={1}\n                        value={position}\n                        valueLabelDisplay=\"off\"\n                        onChange={handleChange}\n                    />\n                </Grid>\n            )}\n        </Grid>\n    )\n}\n","import { SwitchReg, SwitchVariant } from \"../../../jacdac-ts/src/jdom/constants\";\nimport { useRegisterBoolValue, useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\";\nimport useServiceHost from \"../hooks/useServiceHost\";\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\";\nimport SwitchServiceHost from \"../../../jacdac-ts/src/hosts/switchservicehost\"\nimport React from \"react\";\nimport { Switch } from \"@material-ui/core\";\nimport { useId } from \"react-use-id-hook\"\nimport ButtonWidget from \"../widgets/ButtonWidget\";\nimport LoadingProgress from \"../ui/LoadingProgress\";\n\nexport default function DashboardSwitch(props: DashboardServiceProps) {\n    const { service } = props;\n\n    const labelId = useId();\n    const on = useRegisterBoolValue(service.register(SwitchReg.Active), props)\n    const [switchVariant] = useRegisterUnpackedValue<[SwitchVariant]>(service.register(SwitchReg.Variant), props);\n    const host = useServiceHost<SwitchServiceHost>(service);\n    const color = host ? \"secondary\" : \"primary\";\n    const widgetSize = `clamp(5em, 25vw, 100%)`\n\n    const handleToggle = () => host?.toggle();\n\n    if (on === undefined)\n        return <LoadingProgress />;\n\n    switch (switchVariant) {\n        case SwitchVariant.PushButton:\n            return <ButtonWidget\n                checked={on}\n                color={color}\n                label={on ? \"on\" : \"off\"}\n                onDown={host && handleToggle}\n                size={widgetSize} />\n        default:\n            return <>\n                <Switch aria-labelledby={labelId} color={color} checked={on} onChange={host && handleToggle} />\n                <label id={labelId}>{on ? \"on\" : \"off\"}</label>\n            </>\n    }\n}","import React, {\n    createElement,\n    FunctionComponent,\n    lazy,\n    useMemo,\n    Suspense,\n} from \"react\"\nimport {\n    SRV_ACCELEROMETER,\n    SRV_ANALOG_BUTTON,\n    SRV_ARCADE_GAMEPAD,\n    SRV_BUTTON,\n    SRV_BUZZER,\n    SRV_CHARACTER_SCREEN,\n    SRV_COLOR,\n    SRV_COMPASS,\n    SRV_GYROSCOPE,\n    SRV_JOYSTICK,\n    SRV_LED,\n    SRV_LED_MATRIX,\n    SRV_LED_PIXEL,\n    SRV_MATRIX_KEYPAD,\n    SRV_MOTION,\n    SRV_POWER,\n    SRV_RAIN_GAUGE,\n    SRV_REAL_TIME_CLOCK,\n    SRV_REFLECTED_LIGHT,\n    SRV_RNG,\n    SRV_ROLE_MANAGER,\n    SRV_ROTARY_ENCODER,\n    SRV_SERVO,\n    SRV_SEVEN_SEGMENT_DISPLAY,\n    SRV_SOIL_MOISTURE,\n    SRV_SOLENOID,\n    SRV_SOUND_LEVEL,\n    SRV_SOUND_PLAYER,\n    SRV_SOUND_SPECTRUM,\n    SRV_SPEECH_SYNTHESIS,\n    SRV_SWITCH,\n    SRV_TRAFFIC_LIGHT,\n    SRV_WATER_LEVEL,\n    SRV_WIND_DIRECTION,\n    SystemReg,\n} from \"../../../jacdac-ts/src/jdom/constants\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\nimport { isRegister } from \"../../../jacdac-ts/src/jdom/spec\"\nimport RegisterInput from \"../RegisterInput\"\nimport { JDRegister } from \"../../../jacdac-ts/src/jdom/register\"\nimport { useRegisterBoolValue, useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport { CircularProgress, NoSsr } from \"@material-ui/core\"\nimport useServiceHost from \"../hooks/useServiceHost\"\n\n// bundled\nimport DashboardButton from \"./DashboardButton\"\nimport DashboardServo from \"./DashboardServo\"\nimport DashboardRotaryEncoder from \"./DashboardRotaryEncoder\"\nimport DashboardSwitch from \"./DashboardSwitch\"\n\n// lazy devices\nconst DashboardAccelerometer = lazy(() => import(\"./DashboardAccelerometer\"))\nconst DashboardBuzzer = lazy(() => import(\"./DashboardBuzzer\"))\nconst DashboardLEDPixel = lazy(() => import(\"./DashboardLEDPixel\"))\nconst DashboardRoleManager = lazy(() => import(\"./DashboardRoleManager\"))\nconst DashboardTrafficLight = lazy(() => import(\"./DashboardTrafficLight\"))\nconst DashboardCharacterScreen = lazy(\n    () => import(\"./DashboardCharacterScreen\")\n)\nconst DashboardRainGauge = lazy(() => import(\"./DashboardRainGauge\"))\nconst DashboardLEDMatrix = lazy(() => import(\"./DashboardLEDMatrix\"))\nconst DashboardArcadeGamepad = lazy(() => import(\"./DashboardArcadeGamepad\"))\nconst DashboardWindDirection = lazy(() => import(\"./DashboardWindDirection\"))\nconst DashboardMatrixKeypad = lazy(() => import(\"./DashboardMatrixKeypad\"))\nconst DashboardReflectedLight = lazy(() => import(\"./DashboardReflectedLight\"))\nconst DashboardPower = lazy(() => import(\"./DashboardPower\"))\nconst DashboardSpeechSynthesis = lazy(\n    () => import(\"./DashboardSpeechSynthesis\")\n)\nconst DashboardSoilMoisture = lazy(() => import(\"./DashboardSoilMoisture\"))\nconst DashboardRealTimeClock = lazy(() => import(\"./DashboardRealTimeClock\"))\nconst DashboardLED = lazy(() => import(\"./DashboardLED\"))\nconst DashboardJoystick = lazy(() => import(\"./DashboardJoystick\"))\nconst DashboardSevenSegmentDisplay = lazy(\n    () => import(\"./DashboardSevenSegmentDisplay\")\n)\nconst DashboardMotion = lazy(() => import(\"./DashboardMotion\"))\nconst DashboardWaterLevel = lazy(() => import(\"./DashboardWaterLevel\"))\nconst DashboardColor = lazy(() => import(\"./DashboardColor\"))\nconst DashboardSoundPlayer = lazy(() => import(\"./DashboardSoundPlayer\"))\nconst DashboardAnalogButton = lazy(() => import(\"./DashboardAnalogButton\"))\nconst DashboardSoundLevel = lazy(() => import(\"./DashboardSoundLevel\"))\nconst DashboardSoundSpectrum = lazy(() => import(\"./DashboardSoundSpectrum\"))\nconst DashboardRandomNumberGenerator = lazy(\n    () => import(\"./DashboardRandomNumberGenerator\")\n)\nconst DashboardCompass = lazy(() => import(\"./DashboardCompass\"))\nconst DashboardGyroscope = lazy(() => import(\"./DashboardGyroscope\"))\nconst DashboardSolenoid = lazy(() => import(\"./DashboardSolenoid\"))\n\nexport interface DashboardServiceProps {\n    service: JDService\n    expanded?: boolean\n    // all widget services\n    services?: JDService[]\n    variant?: \"icon\" | \"\"\n    // the dashboard html element is in the view\n    visible?: boolean\n}\nexport type DashboardServiceComponent = FunctionComponent<DashboardServiceProps>\n\nconst serviceViews: {\n    [serviceClass: number]: {\n        component: DashboardServiceComponent\n        bundled?: boolean\n        weight?: (service: JDService) => number\n    }\n} = {\n    [SRV_ROLE_MANAGER]: {\n        component: DashboardRoleManager,\n        weight: () => 2,\n    },\n    [SRV_BUZZER]: {\n        component: DashboardBuzzer,\n        weight: () => 2,\n    },\n    [SRV_LED_PIXEL]: {\n        component: DashboardLEDPixel,\n        weight: () => 2,\n    },\n    [SRV_ACCELEROMETER]: {\n        component: DashboardAccelerometer,\n        weight: () => 3,\n    },\n    [SRV_ROTARY_ENCODER]: {\n        component: DashboardRotaryEncoder,\n        bundled: true,\n        weight: () => 2,\n    },\n    [SRV_BUTTON]: {\n        component: DashboardButton,\n        bundled: true,\n    },\n    [SRV_SERVO]: {\n        component: DashboardServo,\n        bundled: true,\n    },\n    [SRV_SWITCH]: {\n        component: DashboardSwitch,\n        bundled: true,\n    },\n    [SRV_TRAFFIC_LIGHT]: {\n        component: DashboardTrafficLight,\n    },\n    [SRV_CHARACTER_SCREEN]: {\n        component: DashboardCharacterScreen,\n        weight: () => 3,\n    },\n    [SRV_RAIN_GAUGE]: {\n        component: DashboardRainGauge,\n    },\n    [SRV_LED_MATRIX]: {\n        component: DashboardLEDMatrix,\n        weight: () => 3,\n    },\n    [SRV_ARCADE_GAMEPAD]: {\n        component: DashboardArcadeGamepad,\n        weight: () => 3,\n    },\n    [SRV_WIND_DIRECTION]: {\n        component: DashboardWindDirection,\n    },\n    [SRV_MATRIX_KEYPAD]: {\n        component: DashboardMatrixKeypad,\n    },\n    [SRV_REFLECTED_LIGHT]: {\n        component: DashboardReflectedLight,\n    },\n    [SRV_POWER]: {\n        component: DashboardPower,\n    },\n    [SRV_SPEECH_SYNTHESIS]: {\n        component: DashboardSpeechSynthesis,\n    },\n    [SRV_SOIL_MOISTURE]: {\n        component: DashboardSoilMoisture,\n    },\n    [SRV_REAL_TIME_CLOCK]: {\n        component: DashboardRealTimeClock,\n    },\n    [SRV_LED]: {\n        component: DashboardLED,\n    },\n    [SRV_JOYSTICK]: {\n        component: DashboardJoystick,\n    },\n    [SRV_SEVEN_SEGMENT_DISPLAY]: {\n        component: DashboardSevenSegmentDisplay,\n    },\n    [SRV_MOTION]: {\n        component: DashboardMotion,\n    },\n    [SRV_WATER_LEVEL]: {\n        component: DashboardWaterLevel,\n    },\n    [SRV_COLOR]: {\n        component: DashboardColor,\n        weight: () => 2,\n    },\n    [SRV_SOUND_PLAYER]: {\n        component: DashboardSoundPlayer,\n        weight: () => 2,\n    },\n    [SRV_ANALOG_BUTTON]: {\n        component: DashboardAnalogButton,\n    },\n    [SRV_SOUND_LEVEL]: {\n        component: DashboardSoundLevel,\n        weight: () => 2,\n    },\n    [SRV_RNG]: {\n        component: DashboardRandomNumberGenerator,\n    },\n    [SRV_COMPASS]: {\n        component: DashboardCompass,\n    },\n    [SRV_GYROSCOPE]: {\n        component: DashboardGyroscope,\n        weight: () => 3,\n    },\n    [SRV_SOUND_SPECTRUM]: {\n        component: DashboardSoundSpectrum,\n        weight: () => 2,\n    },\n    [SRV_SOLENOID]: {\n        component: DashboardSolenoid,\n    },\n}\n\nconst collapsedRegisters = [\n    SystemReg.Reading,\n    SystemReg.Value,\n    SystemReg.Intensity,\n]\n\nfunction ValueWidget(\n    props: {\n        valueRegister: JDRegister\n        intensityRegister: JDRegister\n    } & DashboardServiceProps\n) {\n    const { valueRegister, intensityRegister, ...others } = props\n    const { visible } = others\n    const intensity = useRegisterBoolValue(\n        intensityRegister,\n        others\n    )\n    const hasIntensity = intensity !== undefined\n    const off = hasIntensity ? !intensity : undefined\n    const toggleOff = async () => {\n        await intensityRegister.sendSetBoolAsync(off, true)\n    }\n\n    return (\n        <RegisterInput\n            register={valueRegister}\n            variant={\"widget\"}\n            showServiceName={false}\n            showRegisterName={false}\n            hideMissingValues={true}\n            off={off}\n            toggleOff={hasIntensity ? toggleOff : undefined}\n            visible={visible}\n        />\n    )\n}\n\nfunction IntensityWidget(\n    props: { intensityRegister: JDRegister } & DashboardServiceProps\n) {\n    const { intensityRegister, ...others } = props\n    const { visible } = others\n    const [intensity] = useRegisterUnpackedValue<[number | boolean]>(\n        intensityRegister,\n        others\n    )\n    const off = intensity !== undefined && !intensity\n\n    return (\n        <RegisterInput\n            register={intensityRegister}\n            variant={\"widget\"}\n            showServiceName={false}\n            showRegisterName={false}\n            hideMissingValues={true}\n            off={off}\n            visible={visible}\n        />\n    )\n}\n\nfunction DefaultWidget(props: DashboardServiceProps) {\n    const { service, visible } = props\n    const { specification } = service\n    const register = useMemo(() => {\n        const rspec = specification?.packets.find(\n            pkt =>\n                isRegister(pkt) &&\n                collapsedRegisters.indexOf(pkt.identifier) > -1\n        )\n        return service.register(rspec?.identifier)\n    }, [service])\n\n    if (!register)\n        // nothing to see here\n        return null\n\n    // if register is value, disable if enabled is 0.\n    if (register.specification.identifier == SystemReg.Value) {\n        const intensityRegister = register.service.register(SystemReg.Intensity)\n        return (\n            <ValueWidget\n                valueRegister={register}\n                intensityRegister={intensityRegister}\n                {...props}\n            />\n        )\n    }\n\n    // case of no streaming,value just intensity, like a relay\n    if (register.specification.identifier === SystemReg.Intensity)\n        return <IntensityWidget intensityRegister={register} {...props} />\n\n    return (\n        <RegisterInput\n            register={register}\n            variant={\"widget\"}\n            showServiceName={false}\n            showRegisterName={false}\n            hideMissingValues={true}\n            visible={visible}\n        />\n    )\n}\n\nexport default function DashboardServiceWidget(\n    props: React.Attributes & DashboardServiceProps\n): JSX.Element {\n    const { service } = props\n    const { specification } = service\n    const { component, bundled } =\n        serviceViews[specification.classIdentifier] || {}\n    const host = useServiceHost(service)\n    const color = host ? \"secondary\" : \"primary\"\n    // no special support\n    if (!component) return createElement(DefaultWidget, props)\n\n    // precompiled\n    if (bundled) return createElement(component, props)\n\n    // lazy loading\n    return (\n        <NoSsr>\n            <Suspense\n                fallback={\n                    <CircularProgress\n                        color={color}\n                        disableShrink={true}\n                        variant={\"indeterminate\"}\n                        size={\"3em\"}\n                    />\n                }\n            >\n                {createElement(component, props)}\n            </Suspense>\n        </NoSsr>\n    )\n}\n\nexport function dashboardServiceWeight(service: JDService) {\n    const view = serviceViews[service.serviceClass]\n    return view?.weight?.(service)\n}\n"],"sourceRoot":""}